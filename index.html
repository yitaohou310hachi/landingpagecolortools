<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>官方页色值生成工具</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500&family=Noto+Sans+SC:wght@400;500;600&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg: #f5f5f5;
      --surface: #ffffff;
      --border: #e0e0e0;
      --text: #000000;
      --text-muted: #666666;
      --accent: #07C160;
      --accent-hover: #06ad56;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Noto Sans SC', -apple-system, BlinkMacSystemFont, sans-serif;
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
      line-height: 1.6;
      margin: 0;
      overflow: hidden;
    }

    .page-brand {
      font-size: 0.85rem;
      color: #B2B2B2;
      margin-bottom: 1.5rem;
    }

    .left-panel {
      position: fixed;
      left: 0;
      top: 0;
      width: 510px;
      min-width: 510px;
      padding: 2rem;
      background: var(--bg);
      border-right: 1px solid var(--border);
      display: flex;
      flex-direction: column;
      height: 100vh;
      overflow-y: auto;
      z-index: 1;
    }

    .left-content {
      flex: 1;
    }

    .left-footer {
      margin-top: auto;
      padding-top: 2rem;
      font-size: 0.85rem;
      color: #B2B2B2;
    }

    h1 {
      font-size: 1.0rem;
      font-weight: 600;
      margin-bottom: 0.4rem;
      letter-spacing: 0.02em;
    }

    .subtitle {
      font-size: 0.8rem;
      color: #B2B2B2;
      margin-bottom: 2rem;
      letter-spacing: 0.02em;
      line-height: 1.5;
    }

    .input-section-title {
      font-size: 1rem;
      font-weight: 600;
      color: var(--text);
      margin-bottom: 1.25rem;
    }

    .input-group {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 1rem;
      margin-bottom: 1rem;
      box-shadow: 0 1px 3px rgba(0,0,0,0.04);
    }

    .input-group label {
      display: block;
      font-size: 0.85rem;
      font-weight: 500;
      margin-bottom: 0.5rem;
      color: var(--text-muted);
    }

    .input-row {
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }

    .input-row input[type="color"] {
      width: 40px;
      height: 40px;
      border: 2px solid var(--border);
      border-radius: 4px;
      cursor: pointer;
      background: none;
    }

    .input-row input[type="text"] {
      flex: 1;
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.9rem;
      padding: 0.5rem 0.75rem;
      background: var(--bg);
      border: 1px solid var(--border);
      border-radius: 6px;
      color: var(--text);
      outline: none;
    }

    .input-row input[type="text"]:focus {
      border-color: var(--accent);
    }

    .right-panel {
      margin-left: 510px;
      height: 100vh;
      overflow-y: auto;
      padding: 2rem;
      min-width: 0;
    }

    .output-section {
      max-width: 1000px;
    }

    .module {
      margin-bottom: 2.5rem;
    }

    .module-title {
      font-size: 1rem;
      font-weight: 600;
      color: var(--text);
      margin-bottom: 1rem;
      padding-bottom: 0.5rem;
      border-bottom: 1px solid var(--border);
    }

    .module-with-preview {
      display: grid;
      grid-template-columns: 280px minmax(380px, 1fr);
      gap: 2rem;
      align-items: start;
    }

    .module-simple .module-title {
      margin-bottom: 1rem;
    }

    .preview-window {
      width: 280px;
      min-width: 280px;
      max-width: 280px;
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 1rem;
      box-shadow: 0 2px 8px rgba(0,0,0,0.06);
    }

    .preview-video {
      font-size: 0.75rem;
    }

    .preview-video .video-card {
      background: var(--prev-card-bg, #fff);
      border-radius: 6px;
      overflow: hidden;
      margin-bottom: 0.5rem;
    }

    .preview-video .video-thumb {
      aspect-ratio: 16/9;
      background: var(--prev-theme);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 1.5rem;
    }

    .preview-video .video-info {
      padding: 0.5rem 0.75rem;
      background: var(--prev-card-bg);
      color: var(--prev-comment-text);
    }

    .preview-video .video-comments {
      padding: 0.5rem 0.75rem;
      background: var(--prev-comment-bg);
      color: var(--prev-comment-text);
      font-size: 0.7rem;
      line-height: 1.6;
    }

    .preview-video .segment-btns {
      display: flex;
      gap: 0.5rem;
      margin-top: 0.5rem;
    }

    .preview-video .segment-btn {
      padding: 0.25rem 0.6rem;
      font-size: 0.7rem;
      border-radius: 4px;
      background: var(--prev-segment-bg);
      color: var(--prev-segment-text);
      border: none;
    }

    .preview-video .expand-link {
      font-size: 0.7rem;
      color: var(--prev-theme);
      margin-top: 0.5rem;
      display: inline-block;
      cursor: default;
    }

    .preview-gift .gift-tabs {
      display: flex;
      gap: 0.25rem;
      margin-bottom: 0.75rem;
    }

    .preview-gift .gift-tab {
      padding: 0.35rem 0.75rem;
      font-size: 0.75rem;
      border-radius: 4px;
      background: var(--prev-normal-bg);
      color: var(--prev-normal-text);
      border: none;
    }

    .preview-gift .gift-tab.selected {
      background: var(--prev-selected-bg);
      color: var(--prev-selected-text);
    }

    .preview-gift .gift-card {
      background: var(--prev-gift-card);
      border: 1px solid var(--border);
      border-radius: 6px;
      padding: 0.75rem;
      margin-bottom: 0.5rem;
      font-size: 0.75rem;
    }

    .preview-gift .gift-card .name { font-weight: 500; color: var(--text); }
    .preview-gift .gift-card .brand { color: var(--text-muted); font-size: 0.7rem; }
    .preview-gift .gift-card .price { color: var(--prev-theme); margin-top: 0.25rem; }

    .preview-conversion .conv-card {
      background: var(--prev-card-bg);
      border: 1px solid var(--prev-card-border);
      border-radius: 6px;
      padding: 0.75rem;
      margin-bottom: 0.5rem;
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }

    .preview-conversion .conv-avatar {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      background: var(--border);
      flex-shrink: 0;
    }

    .preview-conversion .conv-info { flex: 1; min-width: 0; }
    .preview-conversion .conv-title {
      font-size: 0.85rem;
      font-weight: 500;
      color: var(--prev-title);
    }

    .preview-conversion .conv-desc {
      font-size: 0.75rem;
      color: var(--prev-desc);
    }

    .preview-conversion .conv-btn {
      padding: 0.35rem 0.75rem;
      font-size: 0.75rem;
      border-radius: 4px;
      background: var(--prev-btn-bg);
      color: var(--prev-btn-text);
      border: none;
    }

    .color-list {
      min-width: 0;
    }

    .color-row {
      display: grid;
      grid-template-columns: 140px minmax(0, 1fr) auto;
      align-items: center;
      gap: 1rem;
      padding: 0.5rem 0;
      border-bottom: 1px solid var(--border);
      font-size: 0.85rem;
    }

    .color-row:last-child {
      border-bottom: none;
    }

    .color-label {
      color: var(--text-muted);
      font-size: 0.8rem;
    }

    .color-value {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.8rem;
      color: var(--text);
      white-space: nowrap;
    }

    .color-preview {
      width: 20px;
      height: 20px;
      border-radius: 4px;
      border: 1px solid var(--border);
      flex-shrink: 0;
    }

    .copy-btn {
      padding: 0.35rem 0.7rem;
      font-size: 0.75rem;
      font-family: inherit;
      background: var(--accent);
      color: #fff;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      transition: background 0.2s;
    }

    .copy-btn:hover {
      background: var(--accent-hover);
    }

    .copy-btn.copied {
      background: #22c55e;
    }

    .color-row-wrapper {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    @media (max-width: 900px) {
      body { overflow: auto; }
      .left-panel {
        position: relative;
        width: 100%;
        min-width: auto;
        height: auto;
        border-right: none;
        border-bottom: 1px solid var(--border);
      }
      .right-panel {
        margin-left: 0;
        height: auto;
      }
      .module-with-preview {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <aside class="left-panel">
    <div class="page-brand">Yitaohou｜Wechat Ads Design</div>
    <div class="left-content">
      <h1>官方页色值自动生成工具</h1>
      <p class="subtitle">建议按照以下色值进行页面设置，最终效果以审核为准</p>

      <div class="input-section-title">色值输入</div>
      <div class="input-group">
        <label>全局背景</label>
        <div class="input-row">
          <input type="color" id="bgColor" value="#490300">
          <input type="text" id="bgHex" value="#490300" placeholder="#490300">
        </div>
      </div>
      <div class="input-group">
        <label>主题色</label>
        <div class="input-row">
          <input type="color" id="themeColor" value="#8F0401">
          <input type="text" id="themeHex" value="#8F0401" placeholder="#8F0401">
        </div>
      </div>
    </div>
    <div class="left-footer">Yitaohou｜Wechat Ads Design</div>
  </aside>

  <main class="right-panel">
    <div class="output-section" id="output"></div>
  </main>

  <script>
    // ========== 工具函数 ==========

    // 解析 Hex 为 RGB (0-255)
    function hexToRgb(hex) {
      hex = hex.replace(/^#/, '');
      if (hex.length === 3) hex = hex[0]+hex[0]+hex[1]+hex[1]+hex[2]+hex[2];
      const r = parseInt(hex.slice(0,2), 16);
      const g = parseInt(hex.slice(2,4), 16);
      const b = parseInt(hex.slice(4,6), 16);
      return { r, g, b };
    }

    // RGB 转 Hex
    function rgbToHex(r, g, b) {
      return [r,g,b].map(x => Math.round(Math.min(255, Math.max(0,x))).toString(16).padStart(2,'0')).join('').toUpperCase();
    }

    // W3C 相对亮度 (0-1)，用于判断深色/浅色
    function getRelativeLuminance(r, g, b) {
      const toLinear = (c) => {
        c = c / 255;
        return c <= 0.04045 ? c / 12.92 : Math.pow((c + 0.055) / 1.055, 2.4);
      };
      return 0.2126 * toLinear(r) + 0.7152 * toLinear(g) + 0.0722 * toLinear(b);
    }

    // 判断是否为深色 (L < 0.5)
    function isDark(r, g, b) {
      return getRelativeLuminance(r, g, b) < 0.5;
    }

    // 混合颜色：color1 * (1 - ratio) + color2 * ratio
    function blend(c1, c2, ratio) {
      return {
        r: c1.r * (1 - ratio) + c2.r * ratio,
        g: c1.g * (1 - ratio) + c2.g * ratio,
        b: c1.b * (1 - ratio) + c2.b * ratio
      };
    }

    // 生成输出字符串 Hex,R,G,B,A
    function toOutputString(r, g, b, a = 100) {
      const hex = rgbToHex(r, g, b);
      const R = Math.round(Math.min(255, Math.max(0, r)));
      const G = Math.round(Math.min(255, Math.max(0, g)));
      const B = Math.round(Math.min(255, Math.max(0, b)));
      const A = Math.round(Math.min(100, Math.max(0, a)));
      return `${hex},${R},${G},${B},${A}`;
    }

    // 颜色对象转 CSS 值
    function toCssValue(c) {
      const r = Math.round(c.r), g = Math.round(c.g), b = Math.round(c.b);
      const a = (c.a ?? 100) / 100;
      return a >= 1 ? `rgb(${r},${g},${b})` : `rgba(${r},${g},${b},${a})`;
    }

    // ========== 颜色计算逻辑 ==========

    function computeColors(bgHex, themeHex) {
      const bg = hexToRgb(bgHex);
      const theme = hexToRgb(themeHex);
      const white = { r: 255, g: 255, b: 255 };
      const black = { r: 0, g: 0, b: 0 };

      const bgDark = isDark(bg.r, bg.g, bg.b);
      const themeDark = isDark(theme.r, theme.g, theme.b);

      const result = {};

      // 【页面样式】
      result['主题色'] = { ...theme, a: 100 };
      result['全局背景'] = { ...bg, a: 100 };

      // 【精选视频】
      result['卡片颜色 - 背景'] = { ...white, a: 100 };
      if (bgDark) {
        result['评论颜色 - 文字'] = { ...white, a: 100 };
        const commentBg = blend(bg, white, 0.1);
        result['评论颜色 - 背景'] = { r: commentBg.r, g: commentBg.g, b: commentBg.b, a: 100 };
        result['分段按钮 - 文字'] = { ...white, a: 80 };
        result['分段按钮 - 背景'] = { ...white, a: 0 };
      } else {
        result['评论颜色 - 文字'] = { ...black, a: 100 };
        result['评论颜色 - 背景'] = { ...white, a: 100 };
        result['分段按钮 - 文字'] = { ...black, a: 50 };
        result['分段按钮 - 背景'] = { ...black, a: 0 };
      }

      // 【好礼合辑】
      if (bgDark) {
        result['选中合辑 - 文字'] = { ...bg, a: 100 };
        result['选中合辑 - 背景'] = { ...white, a: 100 };
        result['普通合辑 - 文字'] = { ...white, a: 100 };
        result['普通合辑 - 背景'] = { ...white, a: 10 };  // 10% opacity white
      } else {
        result['选中合辑 - 文字'] = { ...black, a: 100 };
        result['选中合辑 - 背景'] = { ...white, a: 100 };
        result['普通合辑 - 文字'] = { ...black, a: 50 };
        result['普通合辑 - 背景'] = { ...black, a: 3 };   // 3% opacity black
      }
      result['礼物卡片 - 背景'] = { ...white, a: 100 };

      // 【转化按钮】
      result['文字颜色 - 标题'] = { ...black, a: 100 };
      result['文字颜色 - 描述'] = { r: 127, g: 127, b: 127, a: 100 };
      result['按钮文字 - 文字'] = themeDark ? { ...white, a: 100 } : { ...black, a: 100 };
      result['按钮文字 - 背景'] = { ...theme, a: 100 };
      result['卡片颜色 - 边框'] = { ...white, a: 100 };
      result['卡片颜色 - 背景'] = { ...white, a: 100 };

      return result;
    }

    // ========== 渲染 ==========

    function getPreviewStyle(c) {
      const a = (c.a ?? 100) / 100;
      const r = Math.round(c.r), g = Math.round(c.g), b = Math.round(c.b);
      const checker = 'linear-gradient(45deg,#555 25%,transparent 25%),linear-gradient(-45deg,#555 25%,transparent 25%),linear-gradient(45deg,transparent 75%,#555 75%),linear-gradient(-45deg,transparent 75%,#555 75%)';
      if (a === 0) return `background:${checker};background-size:8px 8px;background-position:0 0,0 4px,4px -4px,-4px 0`;
      if (a < 1) return `background:linear-gradient(rgba(${r},${g},${b},${a}),rgba(${r},${g},${b},${a})),${checker};background-size:auto,8px 8px,8px 8px,8px 8px,8px 8px;background-position:0 0,0 0,0 4px,4px -4px,-4px 0`;
      return `background:rgb(${r},${g},${b});`;
    }

    function renderColorList(colors, keys) {
      return keys.map(key => {
        const c = colors[key];
        const str = toOutputString(c.r, c.g, c.b, c.a ?? 100);
        return `<div class="color-row">
          <span class="color-label">${key}</span>
          <div class="color-row-wrapper">
            <div class="color-preview" style="${getPreviewStyle(c)}"></div>
            <span class="color-value">${str}</span>
          </div>
          <button class="copy-btn" data-copy="${str.replace(/"/g, '&quot;')}">复制</button>
        </div>`;
      }).join('');
    }

    function renderOutput(colors) {
      const themeCss = toCssValue(colors['主题色']);
      const bgCss = toCssValue(colors['全局背景']);
      const cardBg = toCssValue(colors['卡片颜色 - 背景']);
      const commentText = toCssValue(colors['评论颜色 - 文字']);
      const commentBg = toCssValue(colors['评论颜色 - 背景']);
      const segmentText = toCssValue(colors['分段按钮 - 文字']);
      const segmentBg = toCssValue(colors['分段按钮 - 背景']);
      const selectedText = toCssValue(colors['选中合辑 - 文字']);
      const selectedBg = toCssValue(colors['选中合辑 - 背景']);
      const normalText = toCssValue(colors['普通合辑 - 文字']);
      const normalBg = toCssValue(colors['普通合辑 - 背景']);
      const giftCardBg = toCssValue(colors['礼物卡片 - 背景']);
      const titleColor = toCssValue(colors['文字颜色 - 标题']);
      const descColor = toCssValue(colors['文字颜色 - 描述']);
      const btnText = toCssValue(colors['按钮文字 - 文字']);
      const btnBg = toCssValue(colors['按钮文字 - 背景']);
      const cardBorder = toCssValue(colors['卡片颜色 - 边框']);

      const videoPreviewStyle = `--prev-theme:${themeCss};--prev-card-bg:${cardBg};--prev-comment-text:${commentText};--prev-comment-bg:${commentBg};--prev-segment-text:${segmentText};--prev-segment-bg:${segmentBg}`;
      const giftPreviewStyle = `--prev-theme:${themeCss};--prev-selected-text:${selectedText};--prev-selected-bg:${selectedBg};--prev-normal-text:${normalText};--prev-normal-bg:${normalBg};--prev-gift-card:${giftCardBg}`;
      const convPreviewStyle = `--prev-theme:${themeCss};--prev-title:${titleColor};--prev-desc:${descColor};--prev-btn-text:${btnText};--prev-btn-bg:${btnBg};--prev-card-bg:${cardBg};--prev-card-border:${cardBorder}`;

      let html = '';

      // 页面样式 - 仅色值
      html += `<div class="module module-simple">
        <div class="module-title">页面样式</div>
        <div class="color-list">${renderColorList(colors, ['主题色', '全局背景'])}</div>
      </div>`;

      // 精选视频 - 预览 + 色值
      html += `<div class="module">
        <div class="module-title">精选视频</div>
        <div class="module-with-preview">
          <div class="preview-window preview-video" style="${videoPreviewStyle}">
            <div class="video-card">
              <div class="video-thumb">▶</div>
              <div class="video-info">都跟我学! 5分钟解锁丝缎肌的正确方式。<br>@大佬甜er</div>
              <div class="video-comments">此处填写用户评论, 字数需要控制在20字至40字之间, 使内容看起来更丰富。 来自用户评论</div>
              <div class="segment-btns">
                <button class="segment-btn" type="button">首饰</button>
                <button class="segment-btn" type="button">腕表</button>
                <button class="segment-btn" type="button">彩妆</button>
              </div>
              <span class="expand-link">展开</span>
            </div>
          </div>
          <div class="color-list">${renderColorList(colors, ['卡片颜色 - 背景', '评论颜色 - 文字', '评论颜色 - 背景', '分段按钮 - 文字', '分段按钮 - 背景'])}</div>
        </div>
      </div>`;

      // 好礼合辑 - 预览 + 色值
      html += `<div class="module">
        <div class="module-title">好礼合辑</div>
        <div class="module-with-preview">
          <div class="preview-window preview-gift" style="${giftPreviewStyle}">
            <div class="gift-tabs">
              <button class="gift-tab selected" type="button">首饰</button>
              <button class="gift-tab" type="button">腕表</button>
              <button class="gift-tab" type="button">彩妆</button>
            </div>
            <div class="gift-card">
              <div class="name">礼物名称</div>
              <div class="brand">品牌名称</div>
              <div class="price">¥880起</div>
            </div>
            <div class="gift-card">
              <div class="name">礼物名称</div>
              <div class="brand">品牌名称</div>
              <div class="price">¥880起</div>
            </div>
          </div>
          <div class="color-list">${renderColorList(colors, ['选中合辑 - 文字', '选中合辑 - 背景', '普通合辑 - 文字', '普通合辑 - 背景', '礼物卡片 - 背景'])}</div>
        </div>
      </div>`;

      // 转化按钮 - 预览 + 色值
      html += `<div class="module">
        <div class="module-title">转化按钮</div>
        <div class="module-with-preview">
          <div class="preview-window preview-conversion" style="${convPreviewStyle}">
            <div class="conv-card">
              <div class="conv-avatar"></div>
              <div class="conv-info">
                <div class="conv-title">Cartier</div>
                <div class="conv-desc">小程序</div>
              </div>
              <button class="conv-btn" type="button">前往</button>
            </div>
            <div class="conv-card">
              <div class="conv-avatar"></div>
              <div class="conv-info">
                <div class="conv-title">Cartier</div>
                <div class="conv-desc">公众号</div>
              </div>
              <button class="conv-btn" type="button">前往</button>
            </div>
            <div class="conv-card">
              <div class="conv-avatar"></div>
              <div class="conv-info">
                <div class="conv-title">Cartier</div>
                <div class="conv-desc">视频号</div>
              </div>
              <button class="conv-btn" type="button">前往</button>
            </div>
          </div>
          <div class="color-list">${renderColorList(colors, ['文字颜色 - 标题', '文字颜色 - 描述', '按钮文字 - 文字', '按钮文字 - 背景', '卡片颜色 - 边框', '卡片颜色 - 背景'])}</div>
        </div>
      </div>`;

      document.getElementById('output').innerHTML = html;

      // 复制事件
      document.querySelectorAll('.copy-btn').forEach(btn => {
        btn.addEventListener('click', async () => {
          const text = btn.getAttribute('data-copy').replace(/&quot;/g, '"');
          try {
            await navigator.clipboard.writeText(text);
            btn.textContent = '已复制';
            btn.classList.add('copied');
            setTimeout(() => {
              btn.textContent = '复制';
              btn.classList.remove('copied');
            }, 1500);
          } catch (e) {
            btn.textContent = '复制失败';
          }
        });
      });
    }

    function normalizeHex(val) {
      val = val.trim();
      if (!val) return null;
      if (!val.startsWith('#')) val = '#' + val;
      return /^#[0-9A-Fa-f]{3,8}$/.test(val) ? val : null;
    }

    function update() {
      const bgRaw = document.getElementById('bgHex').value.trim() || '#490300';
      const themeRaw = document.getElementById('themeHex').value.trim() || '#8F0401';
      const bgHex = normalizeHex(bgRaw) || '#490300';
      const themeHex = normalizeHex(themeRaw) || '#8F0401';
      document.getElementById('bgColor').value = bgHex;
      document.getElementById('themeColor').value = themeHex;
      const colors = computeColors(bgHex, themeHex);
      renderOutput(colors);
    }

    // ========== 初始化与联动 ==========

    document.getElementById('bgColor').addEventListener('input', (e) => {
      document.getElementById('bgHex').value = e.target.value;
      update();
    });
    document.getElementById('themeColor').addEventListener('input', (e) => {
      document.getElementById('themeHex').value = e.target.value;
      update();
    });
    document.getElementById('bgHex').addEventListener('input', update);
    document.getElementById('themeHex').addEventListener('input', update);

    update();
  </script>
</body>
</html>
